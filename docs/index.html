<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>CARTOFrames &#8212; cartoframes 0.0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="cartoframes">
<h1>CARTOFrames<a class="headerlink" href="#cartoframes" title="Permalink to this headline">¶</a></h1>
<p>A Python package for integrating <a class="reference external" href="https://carto.com/">CARTO</a> maps and services into data science workflows.</p>
<p>Python data analysis workflows often rely on the de facto standards <a class="reference external" href="http://pandas.pydata.org/">pandas</a> and <a class="reference external" href="http://jupyter.org/">Jupyter notebooks</a>. Integrating CARTO into this workflow saves data scientists time and energy by not having to export datasets as files or retain multiple copies of the data. Instead, CARTOFrames give the ability to communicate reproducible analysis while providing the ability to gain from CARTO&#8217;s services like hosted, dynamic or static maps and <a class="reference external" href="https://carto.com/data-observatory/">Data Observatory</a> augmentation.</p>
<div class="section" id="install-instructions">
<h2>Install Instructions<a class="headerlink" href="#install-instructions" title="Permalink to this headline">¶</a></h2>
<p><cite>cartoframes</cite> relies on <a class="reference external" href="http://pandas.pydata.org/">pandas</a> and a development version of the CARTO Python SDK (on branch <a class="reference external" href="https://github.com/CartoDB/carto-python/tree/1.0.0">1.0.0</a>). To install <cite>cartoframes</cite> on your machine, do the following:</p>
<div class="code bash highlight-default"><div class="highlight"><pre><span></span>$ git clone https://github.com/CartoDB/cartoframes.git
$ cd cartoframes
$ pip install -r requirements.txt
$ pip install -e .
</pre></div>
</div>
<p>Once you&#8217;ve done this, <cite>cartoframes</cite> will be installed. See the example usage section below for using <cite>cartoframes</cite> in a Jupyter notebook. <strong>User must have a CARTO API key for writing DataFrames to an account or reading from private tables.</strong></p>
<p><strong>Note:</strong> Eventually <cite>cartoframes</cite> will be fully installable from <cite>pip</cite>.</p>
</div>
<div class="section" id="example-usage">
<h2>Example usage<a class="headerlink" href="#example-usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="data-workflow">
<h3>Data workflow<a class="headerlink" href="#data-workflow" title="Permalink to this headline">¶</a></h3>
<p>Get table from CARTO, make changes in pandas, sync updates with CARTO:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="s1">&#39;https://eschbacher.carto.com/&#39;</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;brooklyn_poverty_census_tracts&#39;</span><span class="p">)</span>
<span class="c1"># do fancy pandas operations (add/drop columns, change values, etc.)</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;poverty_per_pop&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;poverty_count&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;total_population&#39;</span><span class="p">]</span>

<span class="c1"># updates carto table with all changes from this session</span>
<span class="n">cc</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;brooklyn_poverty_census_tracts&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>Associate an existing pandas DataFrame with CARTO.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;acadia_biodiversity.csv&#39;</span><span class="p">)</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;acadia_biodiversity&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="map-workflow">
<h3>Map workflow<a class="headerlink" href="#map-workflow" title="Permalink to this headline">¶</a></h3>
<p>The following will embed a CARTO map in a Jupyter notebook, allowing for custom styling of the maps driven by <a class="reference external" href="https://github.com/CartoDB/turbo-carto">Turbo Carto</a> and <a class="reference external" href="https://carto.com/blog/introducing-cartocolors">CartoColors</a>. See the <a class="reference external" href="https://github.com/CartoDB/CartoColor/wiki/CARTOColor-Scheme-Names">CartoColor wiki</a> for a full list of available color schemes.</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cartoframes</span> <span class="k">import</span> <span class="n">Layer</span><span class="p">,</span> <span class="n">BaseMap</span><span class="p">,</span> <span class="n">styling</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">BaseMap</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">),</span>
               <span class="n">Layer</span><span class="p">(</span><span class="s1">&#39;acadia_biodiversity&#39;</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;simpson_index&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;scheme&#39;</span><span class="p">:</span> <span class="n">styling</span><span class="o">.</span><span class="n">tealRose</span><span class="p">(</span><span class="mi">5</span><span class="p">)}),</span>
               <span class="n">Layer</span><span class="p">(</span><span class="s1">&#39;peregrine_falcon_nest_sites&#39;</span><span class="p">,</span>
                     <span class="n">size</span><span class="o">=</span><span class="s1">&#39;num_eggs&#39;</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;bird_id&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;scheme&#39;</span><span class="p">:</span> <span class="n">styling</span><span class="o">.</span><span class="n">vivid</span><span class="p">(</span><span class="mi">10</span><span class="p">))],</span>
       <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="augment-from-data-observatory">
<h3>Augment from Data Observatory<a class="headerlink" href="#augment-from-data-observatory" title="Permalink to this headline">¶</a></h3>
<p><strong>Note:</strong> This is a provisional function, so the signature may change.</p>
<p>Interact with CARTO&#8217;s <a class="reference external" href="https://carto.com/docs/carto-engine/data">Data Observatory</a>:</p>
<div class="code python highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>

<span class="c1"># total pop, high school diploma (normalized), median income, poverty status (normalized)</span>
<span class="c1"># See Data Observatory catalog for codes: https://cartodb.github.io/bigmetadata/index.html</span>
<span class="n">data_obs_measures</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;numer_id&#39;</span><span class="p">:</span> <span class="s1">&#39;us.census.acs.B01003001&#39;</span><span class="p">},</span>
                     <span class="p">{</span><span class="s1">&#39;numer_id&#39;</span><span class="p">:</span> <span class="s1">&#39;us.census.acs.B15003017&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;normalization&#39;</span><span class="p">:</span> <span class="s1">&#39;predenominated&#39;</span><span class="p">},</span>
                     <span class="p">{</span><span class="s1">&#39;numer_id&#39;</span><span class="p">:</span> <span class="s1">&#39;us.census.acs.B19013001&#39;</span><span class="p">},</span>
                     <span class="p">{</span><span class="s1">&#39;numer_id&#39;</span><span class="p">:</span> <span class="s1">&#39;us.census.acs.B17001002&#39;</span><span class="p">,</span>
                      <span class="s1">&#39;normalization&#39;</span><span class="p">:</span> <span class="s1">&#39;predenominated&#39;</span><span class="p">},]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">do_augment</span><span class="p">(</span><span class="s1">&#39;transactions&#39;</span><span class="p">,</span> <span class="n">data_obs_measures</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
<div class="toctree-wrapper compound">
</div>
</div>
</div>
</div>
<div class="section" id="module-context">
<span id="cartoframe-methods"></span><h1>cartoframe methods<a class="headerlink" href="#module-context" title="Permalink to this headline">¶</a></h1>
<p>CartoContext class for authentication with CARTO and high-level operations
such as reading tables from CARTO into dataframes, writing dataframes to CARTO
tables, and creating custom maps from dataframes and CARTO tables. Future
methods interact with CARTO&#8217;s services like
<a class="reference external" href="https://carto.com/data-observatory">Data Observatory</a>, and <a class="reference external" href="https://carto.com/location-data-services/">routing,
geocoding, and isolines</a>.</p>
<dl class="class">
<dt id="context.CartoContext">
<em class="property">class </em><code class="descclassname">context.</code><code class="descname">CartoContext</code><span class="sig-paren">(</span><em>base_url=None</em>, <em>api_key=None</em>, <em>session=None</em>, <em>verbose=0</em><span class="sig-paren">)</span><a class="headerlink" href="#context.CartoContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Manages connections with CARTO for data and map operations. Modeled
after <a class="reference external" href="https://jaceklaskowski.gitbooks.io/mastering-apache-spark/content/spark-sparkcontext.html">SparkContext</a>.</p>
<p class="rubric">Example</p>
<p>Create a CartoContext object:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>base_url</strong> (<em>str</em>) &#8211; Base URL of CARTO user account. Cloud-based accounts
are of the form <code class="docutils literal"><span class="pre">https://{username}.carto.com</span></code> (e.g.,
<a class="reference external" href="https://eschbacher.carto.com">https://eschbacher.carto.com</a> for user <code class="docutils literal"><span class="pre">eschbacher</span></code>). On-premises
installation users should ask their admin.</li>
<li><strong>api_key</strong> (<em>str</em>) &#8211; CARTO API key.</li>
<li><strong>session</strong> (<em>requests.Session</em><em>, </em><em>optional</em>) &#8211; requests session. See <a class="reference external" href="http://docs.python-requests.org/en/master/user/advanced/">requests
documentation</a>
for more information:</li>
<li><strong>verbose</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; Output underlying process states (True), or
suppress (False, default)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A CartoContext object that is authenticated against
the user&#8217;s CARTO account.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last"><a class="reference internal" href="#context.CartoContext" title="context.CartoContext"><code class="xref py py-obj docutils literal"><span class="pre">CartoContext</span></code></a></p>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="context.CartoContext.data_augment">
<code class="descname">data_augment</code><span class="sig-paren">(</span><em>table_name</em>, <em>metadata</em><span class="sig-paren">)</span><a class="headerlink" href="#context.CartoContext.data_augment" title="Permalink to this definition">¶</a></dt>
<dd><p>Augment an existing CARTO table with <a class="reference external" href="https://carto.com/data-observatory">Data Observatory</a> measures. See the full <a class="reference external" href="https://cartodb.github.io/bigmetadata/index.html">Data
Observatory catalog</a> for all available
measures. The result of this operation is:</p>
<ol class="arabic simple">
<li>It updates <cite>table_name</cite> by adding columns from the Data Observatory</li>
<li>It returns a pandas DataFrame representation of that newly augmented
table.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This method alters <cite>table_name</cite> in the user&#8217;s CARTO database by
adding additional columns. To avoid this, create a copy of the
table first and use the new copy instead.</p>
</div>
<p class="rubric">Example</p>
<p>Add new measures to a CARTO table and pass it to a pandas DataFrame.
Using the &#8220;Median Household Income in the past 12 months&#8221; measure
from the <a class="reference external" href="https://cartodb.github.io/bigmetadata/united_states/income.html#median-household-income-in-the-past-12-months">Data Observatory Catalog</a>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
<span class="n">median_income</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;numer_id&#39;</span><span class="p">:</span> <span class="s1">&#39;us.census.acs.B19013001&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;geom_id&#39;</span><span class="p">:</span> <span class="s1">&#39;us.census.tiger.block_group&#39;</span><span class="p">,</span>
                  <span class="s1">&#39;numer_timespan&#39;</span><span class="p">:</span> <span class="s1">&#39;2011 - 2015&#39;</span><span class="p">}]</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">data_augment</span><span class="p">(</span><span class="s1">&#39;transaction_events&#39;</span><span class="p">,</span>
                     <span class="n">median_income</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>table_name</strong> (<em>str</em>) &#8211; Name of table on CARTO account that Data
Observatory measures are to be added to.</li>
<li><strong>metadata</strong> (<em>list of dicts</em>) &#8211; <p>List of all measures to add to
<cite>table_name</cite>. Each <cite>dict</cite> has the following keys:</p>
<ul>
<li><cite>numer_id</cite> (str): The identifier for the desired measurement</li>
<li><cite>geom_id</cite> (str, optional): Identifier for a desired
geographic boundary level to use when calculating measures.
Will be automatically assigned if undefined</li>
<li><cite>normalization</cite> (str, optional): The desired normalization. One
of &#8216;area&#8217;, &#8216;prenormalized&#8217;, or &#8216;denominated&#8217;. &#8216;Area&#8217; will
normalize the measure per square kilometer, &#8216;prenormalized&#8217;
will return the original value, and &#8216;denominated&#8217; will
normalize by a denominator.</li>
<li><cite>denom_id</cite> (str, optional): Measure ID from DO catalog</li>
<li><cite>numer_timespan</cite> (str, optional): The desired timespan for the
measurement. Defaults to most recent timespan available if
left unspecified.</li>
<li><cite>geom_timespan</cite> (str, optional): The desired timespan for the
geometry. Defaults to timespan matching <cite>numer_timespan</cite> if
left unspecified.</li>
<li><cite>target_area</cite> (str, optional): Instead of aiming to have
<cite>target_geoms</cite> in the area of the geometry passed as extent,
fill this area. Unit is square degrees WGS84. Set this to
<cite>0</cite> if you want to use the smallest source geometry for this
element of metadata, for example if you&#8217;re passing in points.</li>
<li><cite>target_geoms</cite> (str, optional): Override global <cite>target_geoms</cite>
for this element of metadata</li>
<li><cite>max_timespan_rank</cite> (str, optional): Override global
<cite>max_timespan_rank</cite> for this element of metadata</li>
<li><cite>max_score_rank</cite> (str, optional): Override global
<cite>max_score_rank</cite> for this element of metadata</li>
</ul>
</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A DataFrame representation of <cite>table_name</cite> which
has new columns for each measure in <cite>metadata</cite>.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="context.CartoContext.data_boundaries">
<code class="descname">data_boundaries</code><span class="sig-paren">(</span><em>df=None</em>, <em>table_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#context.CartoContext.data_boundaries" title="Permalink to this definition">¶</a></dt>
<dd><p>Not currently implemented</p>
</dd></dl>

<dl class="method">
<dt id="context.CartoContext.data_discovery">
<code class="descname">data_discovery</code><span class="sig-paren">(</span><em>keywords=None</em>, <em>regex=None</em>, <em>time=None</em>, <em>boundary=None</em><span class="sig-paren">)</span><a class="headerlink" href="#context.CartoContext.data_discovery" title="Permalink to this definition">¶</a></dt>
<dd><p>Not currently implemented</p>
</dd></dl>

<dl class="method">
<dt id="context.CartoContext.map">
<code class="descname">map</code><span class="sig-paren">(</span><em>layers=None</em>, <em>interactive=True</em>, <em>zoom=None</em>, <em>lat=None</em>, <em>lng=None</em>, <em>size=(800</em>, <em>400)</em><span class="sig-paren">)</span><a class="headerlink" href="#context.CartoContext.map" title="Permalink to this definition">¶</a></dt>
<dd><p>Produce a CARTO map visualizing data layers.</p>
<p class="rubric">Example</p>
<p>Create a map with two data layers, and one BaseMap layer.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="kn">from</span> <span class="nn">cartoframes</span> <span class="k">import</span> <span class="n">Layer</span><span class="p">,</span> <span class="n">BaseMap</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">BaseMap</span><span class="p">(),</span>
               <span class="n">Layer</span><span class="p">(</span><span class="s1">&#39;acadia_biodiversity&#39;</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;simpson_index&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;scheme&#39;</span><span class="p">:</span> <span class="s1">&#39;TealRose&#39;</span><span class="p">}),</span>
               <span class="n">Layer</span><span class="p">(</span><span class="s1">&#39;peregrine_falcon_nest_sites&#39;</span><span class="p">,</span>
                     <span class="n">size</span><span class="o">=</span><span class="s1">&#39;num_eggs&#39;</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;bird_id&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;scheme&#39;</span><span class="p">:</span> <span class="s1">&#39;Vivid&#39;</span><span class="p">)],</span>
       <span class="n">interactive</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>layers</strong> (<em>list</em><em>, </em><em>optional</em>) &#8211; <p>List of one or more of the following:</p>
<ul>
<li>Layer: cartoframes Layer object for visualizing data from a
CARTO table. See <a class="reference external" href="#layer.Layer">layer.Layer</a> for all
styling options.</li>
<li>BaseMap: Basemap for contextualizng data layers. See
<a class="reference external" href="#layer.BaseMap">layer.BaseMap</a> for all styling options.</li>
<li>QueryLayer: Layer from an arbitrary query. See
<a class="reference external" href="#layer.QueryLayer">layer.QueryLayer</a> for all styling
options.</li>
</ul>
</li>
<li><strong>interactive</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; Defaults to <code class="docutils literal"><span class="pre">True</span></code> to show an
interactive slippy map. Setting to <code class="docutils literal"><span class="pre">False</span></code> creates a static
map.</li>
<li><strong>zoom</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Zoom level of map. Acceptable values are
usually in the range 0 to 19. 0 has the entire earth on a
single tile (256px square). Zoom 19 is the size of a city
block. Must be used in conjunction with <code class="docutils literal"><span class="pre">lng</span></code> and <code class="docutils literal"><span class="pre">lat</span></code>.
Defaults to a view to have all data layers in view.</li>
<li><strong>lat</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Latitude value for the center of the map.
Must be used in conjunction with <code class="docutils literal"><span class="pre">zoom</span></code> and <code class="docutils literal"><span class="pre">lng</span></code>. Defaults
to a view to have all data layers in view.</li>
<li><strong>lng</strong> (<em>float</em><em>, </em><em>optional</em>) &#8211; Longitude value for the center of the map.
Must be used in conjunction with <code class="docutils literal"><span class="pre">zoom</span></code> and <code class="docutils literal"><span class="pre">lat</span></code>. Defaults
to a view to have all data layers in view.</li>
<li><strong>size</strong> (<em>tuple</em><em>, </em><em>optional</em>) &#8211; List of pixel dimensions for the map. Format
is <code class="docutils literal"><span class="pre">(width,</span> <span class="pre">height)</span></code>. Defaults to <code class="docutils literal"><span class="pre">(800,</span> <span class="pre">400)</span></code>.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Interactive maps are rendered in an <code class="docutils literal"><span class="pre">iframe</span></code>,
while static maps are rendered in <code class="docutils literal"><span class="pre">img</span></code> tags.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">IPython.display.HTML</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="context.CartoContext.query">
<code class="descname">query</code><span class="sig-paren">(</span><em>query</em>, <em>table_name=None</em><span class="sig-paren">)</span><a class="headerlink" href="#context.CartoContext.query" title="Permalink to this definition">¶</a></dt>
<dd><p>Pull the result from an arbitrary SQL query from a CARTO account
into a pandas DataFrame. Can also be used to perform database
operations (creating/dropping tables, adding columns, updates, etc.).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>query</strong> (<em>str</em>) &#8211; Query to run against CARTO user database.</li>
<li><strong>table_name</strong> (<em>str</em><em>, </em><em>optional</em>) &#8211; If set, this will create a new
table in the user&#8217;s CARTO account that is the result of the
query. Defaults to None (no table created).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">DataFrame representation of query supplied.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="context.CartoContext.read">
<code class="descname">read</code><span class="sig-paren">(</span><em>table_name</em>, <em>limit=None</em>, <em>index='cartodb_id'</em><span class="sig-paren">)</span><a class="headerlink" href="#context.CartoContext.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read tables from CARTO into pandas DataFrames.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">cc</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;acadia_biodiversity&#39;</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>table_name</strong> (<em>str</em>) &#8211; Name of table in user&#8217;s CARTO account.</li>
<li><strong>limit</strong> (<em>int</em><em>, </em><em>optional</em>) &#8211; Read only <code class="docutils literal"><span class="pre">limit</span></code> lines from
<code class="docutils literal"><span class="pre">table_name</span></code>. Defaults to <cite>None</cite>, which reads the full table.</li>
<li><strong>index</strong> (<em>str</em><em>, </em><em>optional</em>) &#8211; Not currently in use.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">DataFrame representation of <cite>table_name</cite> from
CARTO.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">pandas.DataFrame</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="context.CartoContext.sync">
<code class="descname">sync</code><span class="sig-paren">(</span><em>dataframe</em>, <em>table_name</em><span class="sig-paren">)</span><a class="headerlink" href="#context.CartoContext.sync" title="Permalink to this definition">¶</a></dt>
<dd><p>Depending on the size of the DataFrame or CARTO table, perform
granular operations on a DataFrame to only update the changed cells
instead of a bulk upload. If on the large side, perform granular
operations, if on the smaller side use Import API.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Not yet implemented.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="context.CartoContext.write">
<code class="descname">write</code><span class="sig-paren">(</span><em>df</em>, <em>table_name</em>, <em>temp_dir='/tmp'</em>, <em>overwrite=False</em>, <em>lnglat=None</em><span class="sig-paren">)</span><a class="headerlink" href="#context.CartoContext.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a DataFrame to a CARTO table.</p>
<p>Example:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cc</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;brooklyn_poverty&#39;</span><span class="p">,</span> <span class="n">overwrite</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>df</strong> (<em>pandas.DataFrame</em>) &#8211; DataFrame to write to <code class="docutils literal"><span class="pre">table_name</span></code> in user
CARTO account</li>
<li><strong>table_name</strong> (<em>str</em>) &#8211; Table to write <code class="docutils literal"><span class="pre">df</span></code> to in CARTO.</li>
<li><strong>temp_dir</strong> (<em>str</em><em>, </em><em>optional</em>) &#8211; Directory for temporary storage of data
that is sent to CARTO. Defaults to <code class="docutils literal"><span class="pre">/tmp</span></code> (Unix-like systems).</li>
<li><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; Behavior for overwriting <code class="docutils literal"><span class="pre">table_name</span></code>
if it exits on CARTO. Defaults to <code class="docutils literal"><span class="pre">False</span></code>.</li>
<li><strong>lnglat</strong> (<em>tuple</em><em>, </em><em>optional</em>) &#8211; lng/lat pair that can be used for creating
a geometry on CARTO. Defaults to <code class="docutils literal"><span class="pre">None</span></code>. In some cases,
geometry will be created without specifying this. See CARTO&#8217;s
<a class="reference external" href="https://carto.com/docs/carto-engine/import-api/standard-tables">Import API</a>
for more information.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<span class="target" id="module-layer"></span><p>Layer classes for map creation. See examples in <a class="reference external" href="#layer.Layer">layer.Layer</a>
and <a class="reference external" href="#layer.QueryLayer">layer.QueryLayer</a> for example usage.</p>
<dl class="class">
<dt id="layer.AbstractLayer">
<em class="property">class </em><code class="descclassname">layer.</code><code class="descname">AbstractLayer</code><a class="headerlink" href="#layer.AbstractLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract Layer object</p>
</dd></dl>

<dl class="class">
<dt id="layer.BaseMap">
<em class="property">class </em><code class="descclassname">layer.</code><code class="descname">BaseMap</code><span class="sig-paren">(</span><em>source='dark'</em>, <em>labels='back'</em>, <em>only_labels=False</em><span class="sig-paren">)</span><a class="headerlink" href="#layer.BaseMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Layer object for adding basemaps to a cartoframes map.</p>
<p class="rubric">Example</p>
<p>Add a custom basemap to a cartoframes map.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="kn">from</span> <span class="nn">cartoframes</span> <span class="k">import</span> <span class="n">BaseMap</span><span class="p">,</span> <span class="n">Layer</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">BaseMap</span><span class="p">(</span><span class="n">source</span><span class="o">=</span><span class="s1">&#39;light&#39;</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="s1">&#39;front&#39;</span><span class="p">),</span>
               <span class="n">Layer</span><span class="p">(</span><span class="s1">&#39;acadia_biodiversity&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>source</strong> (<em>str</em><em>, </em><em>optional</em>) &#8211; One of <code class="docutils literal"><span class="pre">light</span></code> or <code class="docutils literal"><span class="pre">dark</span></code>. Defaults to <code class="docutils literal"><span class="pre">dark</span></code>.
Basemaps come from
<a class="reference external" href="https://carto.com/location-data-services/basemaps/">https://carto.com/location-data-services/basemaps/</a></li>
<li><strong>labels</strong> (<em>str</em><em>, </em><em>optional</em>) &#8211; One of <code class="docutils literal"><span class="pre">back</span></code>, <code class="docutils literal"><span class="pre">front</span></code>, or None. Labels on the
front will be above the data layers. Labels on back will be
underneath the data layers but on top of the basemap. Setting
labels to <code class="docutils literal"><span class="pre">None</span></code> will only show the basemap.</li>
<li><strong>only_labels</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; Whether to show labels or not.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="layer.BaseMap.is_basic">
<code class="descname">is_basic</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#layer.BaseMap.is_basic" title="Permalink to this definition">¶</a></dt>
<dd><p>Does BaseMap pull from CARTO default basemaps?</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><cite>True</cite> if using a CARTO basemap (Dark Matter or Positron),
<cite>False</cite> otherwise.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">bool</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="layer.Layer">
<em class="property">class </em><code class="descclassname">layer.</code><code class="descname">Layer</code><span class="sig-paren">(</span><em>table_name</em>, <em>source=None</em>, <em>overwrite=False</em>, <em>time=None</em>, <em>color=None</em>, <em>size=None</em>, <em>tooltip=None</em>, <em>legend=None</em><span class="sig-paren">)</span><a class="headerlink" href="#layer.Layer" title="Permalink to this definition">¶</a></dt>
<dd><p>A cartoframes Data Layer based on a specific table in user&#8217;s CARTO
database. This layer class is useful for visualizing individual datasets
with <a class="reference external" href="#context.CartoContext.map">CartoContext.map()</a>.</p>
<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="kn">from</span> <span class="nn">cartoframes</span> <span class="k">import</span> <span class="n">QueryLayer</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">Layer</span><span class="p">(</span><span class="s1">&#39;fantastic_sql_table&#39;</span><span class="p">,</span>
                     <span class="n">size</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span>
                     <span class="n">color</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;mr_fox_sightings&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;scheme&#39;</span><span class="p">:</span> <span class="s1">&#39;Prism&#39;</span><span class="p">})])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>table_name</strong> (<em>str</em>) &#8211; Table in user CARTO account that is fed into a
pandas DataFrame.</li>
<li><strong>source</strong> (<em>pandas.DataFrame</em><em>, </em><em>optional</em>) &#8211; If specified, writes DataFrame
to the tablename specified (if it does not exist), then creates
a map layer.</li>
<li><strong>overwrite</strong> (<em>bool</em><em>, </em><em>optional</em>) &#8211; If <code class="docutils literal"><span class="pre">table_name</span></code> exists in user&#8217;s CARTO
account, setting this to <cite>True</cite> will overwrite it. Defaults to
<cite>False</cite> (do not overwrite).</li>
<li><strong>time</strong> (<em>dict</em><em> or </em><em>str</em><em>, </em><em>optional</em>) &#8211; <p>Style to apply to layer.
If <cite>time</cite> is a <cite>dict</cite>, the following keys are options:</p>
<ul>
<li>column (str, required): Column for animating map from. Data must
be of type time or float.</li>
<li>method (str, optional): Type of aggregation method for operating
on <a class="reference external" href="https://github.com/CartoDB/torque">Torque TileCubes</a>. Must
be one of <code class="docutils literal"><span class="pre">avg</span></code>, <code class="docutils literal"><span class="pre">sum</span></code>, or another <a class="reference external" href="https://www.postgresql.org/docs/9.5/static/functions-aggregate.html">PostgreSQL aggregate
functions</a>
with a numeric output. Defaults to <code class="docutils literal"><span class="pre">count</span></code>.</li>
<li>cumulative (str, optional): Whether to accumulate (<code class="docutils literal"><span class="pre">cumulative</span></code>)
the point data overtime, or show the event at the specified time
only (<code class="docutils literal"><span class="pre">linear</span></code>). Defaults to <code class="docutils literal"><span class="pre">linear</span></code>.</li>
<li>frames (int, optional): Number of frames in the animation.
Defaults to 256.</li>
<li>duration (int, optional): Number of seconds in the animation.
Defaults to 30.</li>
</ul>
<p>If <cite>time</cite> is a <code class="docutils literal"><span class="pre">str</span></code>, then it must be a column name available in
the query that is of type numeric or datetime.</p>
</li>
<li><strong>color</strong> (<em>dict</em><em> or </em><em>str</em><em>, </em><em>optional</em>) &#8211; <p>Color style to apply to map.
If <cite>color</cite> is a <code class="docutils literal"><span class="pre">dict</span></code>, the following keys are options, with
values described:</p>
<ul>
<li>column (str): Column to base coloring from.</li>
<li>scheme (str, optinal): Color scheme from
<a class="reference external" href="https://github.com/CartoDB/CartoColor/wiki/CARTOColor-Scheme-Names">CartoColors</a>.
Defaults to <cite>Mint</cite>.</li>
<li>bin_method (str, optional): Quantification method for dividing
data range into bins. Must be one of: <code class="docutils literal"><span class="pre">quantiles</span></code>, <code class="docutils literal"><span class="pre">equal</span></code>,
<code class="docutils literal"><span class="pre">headtails</span></code>, or <code class="docutils literal"><span class="pre">jenks</span></code>. Defaults to <code class="docutils literal"><span class="pre">quantiles</span></code>.</li>
<li>bins (int, optional): Number of bins to divide data amongst in
the <cite>bin_method</cite>. Defaults to 5.</li>
</ul>
</li>
<li><strong>size</strong> (<em>dict</em><em> or </em><em>int</em><em>, </em><em>optional</em>) &#8211; <p>Size style to apply to point data.
If <cite>size</cite> is a <code class="docutils literal"><span class="pre">dict</span></code>, the follow keys are options, with values
described as:</p>
<ul>
<li>column (str): Column to base sizing of points on</li>
<li>bin_method (str, optional): Quantification method for dividing
data range into bins. Must be one of: <code class="docutils literal"><span class="pre">quantiles</span></code>, <code class="docutils literal"><span class="pre">equal</span></code>,
<code class="docutils literal"><span class="pre">headtails</span></code>, or <code class="docutils literal"><span class="pre">jenks</span></code>. Defaults to <code class="docutils literal"><span class="pre">quantiles</span></code>.</li>
<li>bins (int, optional): Number of bins to break data into. Defaults
to 5.</li>
<li>max (int, optional): Maximum point width (in pixels). Defaults to
25.</li>
<li>min (int, optional): Minimum point width (in pixels). Defaults to
5.</li>
</ul>
</li>
<li><strong>tooltip</strong> (<em>tuple of str</em><em>, </em><em>optional</em>) &#8211; <strong>Not implemented.</strong></li>
<li><strong>legend</strong> &#8211; <strong>Not implemented.</strong></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="layer.QueryLayer">
<em class="property">class </em><code class="descclassname">layer.</code><code class="descname">QueryLayer</code><span class="sig-paren">(</span><em>query</em>, <em>time=None</em>, <em>color=None</em>, <em>size=None</em>, <em>tooltip=None</em>, <em>legend=None</em><span class="sig-paren">)</span><a class="headerlink" href="#layer.QueryLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>cartoframes Data Layer based on an arbitrary query to the user&#8217;s CARTO
database. This layer class is useful for offloading processing to the cloud
to do some of the following:</p>
<ul class="simple">
<li>pull down a snapshot of the data (e.g., selecting only important columns
instead of all columns in the dataset)</li>
<li>doing spatial processing using <a class="reference external" href="http://postgis.net/">PostGIS</a> and
<a class="reference external" href="https://www.postgresql.org/">PostgreSQL</a>, which is the database
underlying CARTO</li>
<li>performing arbitrary relational database queries (e.g., complex JOINs
in SQL instead of in pandas)</li>
</ul>
<p>Used in <a class="reference external" href="#context.CartoContext.map">CartoContext.map()</a>.</p>
<p class="rubric">Example</p>
<p>Underlay a QueryLayer with a complex query below a layer from a table.
The QueryLayer is colored by the calculated column <code class="docutils literal"><span class="pre">abs_diff</span></code>, and
points are sized by the column <code class="docutils literal"><span class="pre">i_measure</span></code>.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cartoframes</span>
<span class="kn">from</span> <span class="nn">cartoframes</span> <span class="k">import</span> <span class="n">QueryLayer</span>
<span class="n">cc</span> <span class="o">=</span> <span class="n">cartoframes</span><span class="o">.</span><span class="n">CartoContext</span><span class="p">(</span><span class="n">BASEURL</span><span class="p">,</span> <span class="n">APIKEY</span><span class="p">)</span>
<span class="n">cc</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">layers</span><span class="o">=</span><span class="p">[</span><span class="n">QueryLayer</span><span class="p">(</span><span class="s1">&#39;&#39;&#39;</span>
<span class="s1">                          WITH i_cte As (</span>
<span class="s1">                            SELECT</span>
<span class="s1">                                ST_Buffer(the_geom::geography, 500)::geometry As the_geom,</span>
<span class="s1">                                cartodb_id,</span>
<span class="s1">                                measure,</span>
<span class="s1">                                date</span>
<span class="s1">                              FROM interesting_data</span>
<span class="s1">                             WHERE date &gt; &#39;2017-04-19&#39;</span>
<span class="s1">                          )</span>
<span class="s1">                          SELECT</span>
<span class="s1">                             i.cartodb_id, i.the_geom,</span>
<span class="s1">                             ST_Transform(i.the_geom, 3857) AS the_geom_webmercator,</span>
<span class="s1">                             abs(i.measure - j.measure) as abs_diff,</span>
<span class="s1">                             i.measure AS i_measure</span>
<span class="s1">                            FROM i_cte AS i</span>
<span class="s1">                            JOIN awesome_data AS j</span>
<span class="s1">                              ON i.event_id = j.event_id</span>
<span class="s1">                           WHERE j.measure IS NOT NULL</span>
<span class="s1">                             AND j.date &lt; &#39;2017-04-29&#39;</span>
<span class="s1">                          &#39;&#39;&#39;</span><span class="p">,</span>
                          <span class="n">color</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;column&#39;</span><span class="p">:</span> <span class="s1">&#39;abs_diff&#39;</span><span class="p">,</span>
                                 <span class="s1">&#39;scheme&#39;</span><span class="p">:</span> <span class="s1">&#39;SunsetDark&#39;</span><span class="p">},</span>
                          <span class="n">size</span><span class="o">=</span><span class="s1">&#39;i_measure&#39;</span><span class="p">),</span>
               <span class="n">Layer</span><span class="p">(</span><span class="s1">&#39;fantastic_sql_table&#39;</span><span class="p">)])</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>query</strong> (<em>str</em>) &#8211; Query that is fed into a pandas DataFrame. At a minimum, all
queries need to have the columns <cite>cartodb_id</cite>, <cite>the_geom</cite>, and
<cite>the_geom_webmercator</cite>. Read more in
<a class="reference external" href="https://carto.com/docs/tips-and-tricks/geospatial-analysis">CARTO&#8217;s docs</a>
for more information.</li>
<li><strong>time</strong> (<em>dict</em><em> or </em><em>str</em><em>, </em><em>optional</em>) &#8211; <p>Style to apply to layer.
If <cite>time</cite> is a <cite>dict</cite>, the following keys are options:</p>
<ul>
<li>column (str, required): Column for animating map from. Data must
be of type time or float.</li>
<li>method (str, optional): Type of aggregation method for operating
on <a class="reference external" href="https://github.com/CartoDB/torque">Torque TileCubes</a>. Must
be one of <code class="docutils literal"><span class="pre">avg</span></code>, <code class="docutils literal"><span class="pre">sum</span></code>, or another <a class="reference external" href="https://www.postgresql.org/docs/9.5/static/functions-aggregate.html">PostgreSQL aggregate functions</a>
with a numeric output. Defaults to <code class="docutils literal"><span class="pre">count</span></code>.</li>
<li>cumulative (str, optional): Whether to accumulate (<code class="docutils literal"><span class="pre">cumulative</span></code>)
the point data overtime, or show the event at the specified time
only (<code class="docutils literal"><span class="pre">linear</span></code>). Defaults to <code class="docutils literal"><span class="pre">linear</span></code>.</li>
<li>frames (int, optional): Number of frames in the animation.
Defaults to 256.</li>
<li>duration (int, optional): Number of seconds in the animation.
Defaults to 30.</li>
</ul>
<p>If <cite>time</cite> is a <code class="docutils literal"><span class="pre">str</span></code>, then it must be a column name available in
the query that is of type numeric or datetime.</p>
</li>
<li><strong>color</strong> (<em>dict</em><em> or </em><em>str</em><em>, </em><em>optional</em>) &#8211; <p>Color style to apply to map.
If <cite>color</cite> is a <code class="docutils literal"><span class="pre">dict</span></code>, the following keys are options, with
values described:</p>
<ul>
<li>column (str): Column to base coloring from.</li>
<li>scheme (str, optinal): Color scheme from
<a class="reference external" href="https://github.com/CartoDB/CartoColor/wiki/CARTOColor-Scheme-Names">CartoColors</a>.
Defaults to <cite>Mint</cite>.</li>
<li>bin_method (str, optional): Quantification method for dividing
data range into bins. Must be one of: <code class="docutils literal"><span class="pre">quantiles</span></code>, <code class="docutils literal"><span class="pre">equal</span></code>,
<code class="docutils literal"><span class="pre">headtails</span></code>, or <code class="docutils literal"><span class="pre">jenks</span></code>. Defaults to <code class="docutils literal"><span class="pre">quantiles</span></code>.</li>
<li>bins (int, optional): Number of bins to divide data amongst in
the <cite>bin_method</cite>. Defaults to 5.</li>
</ul>
</li>
<li><strong>size</strong> (<em>dict</em><em> or </em><em>int</em><em>, </em><em>optional</em>) &#8211; <p>Size style to apply to point data.
If <cite>size</cite> is a <code class="docutils literal"><span class="pre">dict</span></code>, the follow keys are options, with values
described as:</p>
<ul>
<li>column (str): Column to base sizing of points on</li>
<li>bin_method (str, optional): Quantification method for dividing
data range into bins. Must be one of: <code class="docutils literal"><span class="pre">quantiles</span></code>, <code class="docutils literal"><span class="pre">equal</span></code>,
<code class="docutils literal"><span class="pre">headtails</span></code>, or <code class="docutils literal"><span class="pre">jenks</span></code>. Defaults to <code class="docutils literal"><span class="pre">quantiles</span></code>.</li>
<li>bins (int, optional): Number of bins to break data into. Defaults
to 5.</li>
<li>max (int, optional): Maximum point width (in pixels). Defaults to
25.</li>
<li>min (int, optional): Minimum point width (in pixels). Defaults to
5.</li>
</ul>
</li>
<li><strong>tooltip</strong> (<em>tuple</em><em>, </em><em>optional</em>) &#8211; <strong>Not yet implemented.</strong></li>
<li><strong>legend</strong> &#8211; <strong>Not yet implemented.</strong></li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="layer.QueryLayer.get_cartocss">
<code class="descname">get_cartocss</code><span class="sig-paren">(</span><em>basemap</em><span class="sig-paren">)</span><a class="headerlink" href="#layer.QueryLayer.get_cartocss" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate cartocss for class properties</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-maps"></span><p>Utilities for creating map templates for CARTO&#8217;s Named Maps API</p>
<dl class="function">
<dt id="maps.get_map_name">
<code class="descclassname">maps.</code><code class="descname">get_map_name</code><span class="sig-paren">(</span><em>layers</em>, <em>has_zoom</em><span class="sig-paren">)</span><a class="headerlink" href="#maps.get_map_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a map named based on supplied parameters</p>
</dd></dl>

<dl class="function">
<dt id="maps.get_map_template">
<code class="descclassname">maps.</code><code class="descname">get_map_template</code><span class="sig-paren">(</span><em>layers</em>, <em>has_zoom</em><span class="sig-paren">)</span><a class="headerlink" href="#maps.get_map_template" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a map template based on custom parameters supplied</p>
</dd></dl>

<dl class="function">
<dt id="maps.has_time_layer">
<code class="descclassname">maps.</code><code class="descname">has_time_layer</code><span class="sig-paren">(</span><em>layers</em><span class="sig-paren">)</span><a class="headerlink" href="#maps.has_time_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <cite>True</cite> if there is a time/torque layer in <cite>layers.
Returns `False</cite> otherwise</p>
</dd></dl>

<dl class="function">
<dt id="maps.non_basemap_layers">
<code class="descclassname">maps.</code><code class="descname">non_basemap_layers</code><span class="sig-paren">(</span><em>layers</em><span class="sig-paren">)</span><a class="headerlink" href="#maps.non_basemap_layers" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all map layers which are not basemaps</p>
</dd></dl>

<span class="target" id="module-credentials"></span><p>API key utility functions</p>
<dl class="function">
<dt id="credentials.api_key">
<code class="descclassname">credentials.</code><code class="descname">api_key</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#credentials.api_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns stored API key that was set with <cite>cartoframes.keys.set_key</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">CARTO API key</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="credentials.base_url">
<code class="descclassname">credentials.</code><code class="descname">base_url</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#credentials.base_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns stored base_url that was set with <cite>cartoframes.keys.set_base_url</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">CARTO API base URL</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">str</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="credentials.credentials">
<code class="descclassname">credentials.</code><code class="descname">credentials</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#credentials.credentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns stored credentials that was set with
<cite>cartoframes.keys.set_credentials</cite></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Dictionary containing CARTO API base_url and API key.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="credentials.set_api_key">
<code class="descclassname">credentials.</code><code class="descname">set_api_key</code><span class="sig-paren">(</span><em>key</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#credentials.set_api_key" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the CARTO API key so that users can access it via
<cite>cartoframes.keys.api_key()</cite>. This lets users bind an API key to a given
installation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>key</strong> (<em>str</em>) &#8211; CARTO API key</li>
<li><strong>overwrite</strong> (<em>bool</em>) &#8211; Whether to overwrite existing key. Defaults to False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Path to the location of the API key file. Raises FileError if
overwriting is prohibited and the file exists.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="credentials.set_base_url">
<code class="descclassname">credentials.</code><code class="descname">set_base_url</code><span class="sig-paren">(</span><em>base_url</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#credentials.set_base_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the CARTO API base_url so that users can access it via
cartoframes.keys.access_base_url(). This lets users bind their API base_url
to a given installation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>base_url</strong> (<em>str</em>) &#8211; CARTO access URL</li>
<li><strong>overwrite</strong> (<em>bool</em>) &#8211; Whether to overwrite the existing key. Defaults to False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Path to location of the credentials file. Raises FileError if
overwriting is prohibited and the file exists.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="credentials.set_credentials">
<code class="descclassname">credentials.</code><code class="descname">set_credentials</code><span class="sig-paren">(</span><em>base_url=''</em>, <em>api_key=''</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#credentials.set_credentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the CARTO API base URL and API key so that users can access it via
cartoframes.keys.credentials(). This lets users bind their CARTO access
credentials to a given installation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>base_url</strong> (<em>str</em>) &#8211; CARTO API base URL. Defaults to an empty string. Format
is <cite>https://{username}.carto.com/</cite> for cloud users.</li>
<li><strong>api_key</strong> (<em>str</em>) &#8211; CARTO api key. Defaults to an empty string.</li>
<li><strong>overwrite</strong> (<em>bool</em>) &#8211; Whether to overwrite the existing credentials.
Defaults to False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Path to the location of the API key file. Raises <cite>EnvironmentError</cite>
if overwriting is prohibited and the file exists.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">str</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></li>
<li><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></li>
<li><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">CARTOFrames</a><ul>
<li><a class="reference internal" href="#install-instructions">Install Instructions</a></li>
<li><a class="reference internal" href="#example-usage">Example usage</a><ul>
<li><a class="reference internal" href="#data-workflow">Data workflow</a></li>
<li><a class="reference internal" href="#map-workflow">Map workflow</a></li>
<li><a class="reference internal" href="#augment-from-data-observatory">Augment from Data Observatory</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-context">cartoframe methods</a></li>
<li><a class="reference internal" href="#indices-and-tables">Indices and tables</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="#">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017, Andy Eschbacher, Stuart Lynn.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.5.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/index.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>